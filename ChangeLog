2018-02-10  Minsheng Liu  <lambda@liu.ms>

  [close #10] Refactor to use FixedEffects to manage multiple FixedEffect objects.

  For more background of this commit, see issue #9 and #10 on GitHub.

    https://github.com/xuyiqing/fastplm/issues/9
    https://github.com/xuyiqing/fastplm/issues/10

  We have revamped "CrushQueue", which hopefully is bug free now.
  It supports committing payloads during a crush operation,
  which is required by our new demean algorithm.

  modified:   src/CrushQueue.cpp
  modified:   src/CrushQueue.h

  "FixedEffect" is most renamed to "SimpleFixedEffect".
  In near feature, a new class (possibly named as "ComplexFixedEffect")
  will represent fixed effects interacting with other fixed effects.

  We also have a "FixedEffects" class to manage those effects.
  The next feature to be done is to integrate component analysis to solve
  the singleton issue (see #6).

    https://github.com/xuyiqing/fastplm/issues/6

  Thus, an object of "FixedEffects" will be created on R side, passed to our solver, and kept
  to do component checking by "predict.fixed.effects".

  One thing to note is that "demean" is now a constant method of "FixedEffects".
  Thus, an object of "FixedEffects" will remain constant once created,
  which helps to eliminate potential bugs.

  deleted:    src/FixedEffect.cpp
  deleted:    src/FixedEffect.h
  new file:   src/FixedEffects.cpp
  new file:   src/FixedEffects.h
  modified:   CMakeLists.txt

  Another thing to note is that demean is completely done in "FixedEffects", including
  convergence checking. This enables us to increase granularity of our parallel model
  and hence lowers overhead of multi-threading.

  modified:   src/FixedEffectModel.cpp
  modified:   src/FixedEffectModel.h

  Wrapper files are updated accordingly.

  modified:   R/Wrapper.R
  modified:   src/Wrapper.cpp

  There is no behavior change so no new test is required.
  However, the following test is updated to remove the new pointer held in the output
  so that "expect_identical" could run as desired.

  modified:   tests/testthat/test-parallel-demean-correct.R


2018-01-23  Minsheng Liu  <lambda@liu.ms>

  Add row names to estimated fixed effects.

  modified:   R/Wrapper.R

  Add a test to make sure estimated fixed effects interpreted using row names
  yield estimated fitted values.

  modified:   tests/testthat/make-small-data.R
  new file:   tests/testthat/test-fixed-effects-rownames.R

  Add calls to "unname" in "expect_equal" to account for the changed row/col names.

  modified:   tests/testthat/test-demean-without-x.R


2018-01-21  Minsheng Liu  <lambda@liu.ms>

  Refactor "FastFESolver" to "FixedEffectModel".

  Similar to the "LinearModel" class before, we now employ a functional approach.
  Struct is only used for the bundling of final results.

  modified:   CMakeLists.txt
  modified:   src/Common.h
  deleted:    src/FastFESolver.h
  renamed:    src/FastFESolver.cpp -> src/FixedEffectModel.cpp
  new file:   src/FixedEffectModel.h
  modified:   src/LinearModel.cpp
  modified:   src/LinearModel.h
  deleted:    src/PlainModel.cpp
  deleted:    src/PlainModel.h
  modified:   src/Wrapper.cpp

  The demeaned result is now exposed.
  Bump the version to 0.1.7.0 to reflect the interface change.

  modified:   DESCRIPTION

  Add a test to check the case where X is not present, e.g. using Y and fixed
  effect indicators to estimate fixed effects. Both the runtime wellness of
  the program and the correctness of the estimated results are ensured.

  modified:   tests/testthat/make-small-data.R
  new file:   tests/testthat/test-demean-without-x.R


2018-01-20  Minsheng Liu  <lambda@liu.ms>

  [GARDEN] Rename "CrashQueue" to "CrushQueue".

  It should be obvious that "CrashQueue" is a typo. I intended to crush those
  tasks, not to crash during the computation.

  modified:   CMakeLists.txt
  renamed:    src/CrashQueue.cpp -> src/CrushQueue.cpp
  renamed:    src/CrashQueue.h -> src/CrushQueue.h
  modified:   src/FixedEffect.cpp
  modified:   src/Wrapper.cpp

  Add a test to ensure different core nums yield identical results.

  new file:   tests/testthat/test-parallel-demean-correct.R


2018-01-20  Minsheng Liu  <lambda@liu.ms>

  [GARDEN] Remove a global "using namespace Rcpp" from "Common.h".

  modified:   src/Common.h
  modified:   src/Wrapper.cpp

  There is no behavior change so no new test is required.


2018-01-20  Minsheng Liu  <lambda@liu.ms>

  Move code for the demeaned linear model to a separate class "LinearModel".

  We introduce a new class for solving linear models using "arma::solve".
  The main change to that function is to check linear dependency from the input.

  modified:   CMakeLists.txt
  new file:   src/LinearModel.cpp
  new file:   src/LinearModel.h

  The code is extracted from "FastFESolver.cpp".

  modified:   src/FastFESolver.cpp
  modified:   src/FastFESolver.h

  We also move some helper functions to "Common.h".

  modified:   src/Common.h

  There is no behavior change so no new test is required.


2018-01-09  Minsheng Liu  <lambda@liu.ms>

  A new algorithm to estimate fixed effects after MAP.

  We use the amount of changes the fixed effects projections applied to X and Y
  to recover fixed effects. A more detailed description will be provided as a
  mathematical proof.

  Collect changes of demean:

  modified:   src/FixedEffect.cpp
  modified:   src/FixedEffect.h

  Reconstruct fixed effects:

  modified:   src/FastFESolver.cpp
  modified:   src/FastFESolver.h

  "SlowFESolver" is no longer neeeded:

  deleted:    src/SlowFESolver.cpp
  deleted:    src/SlowFESolver.h

  Since estimating fixed effects requires little computing power, the
  "estimateFE" attribute will be ignored. The estimation of fixed effects
  will always happen.

  modified:   R/Wrapper.R
  modified:   src/Wrapper.cpp

  A more functional code stye is used. Since "make_pair" is used extensively,
  we now require C++ 14 for its return type deduction feature.

  modified:   CMakeLists.txt
  modified:   DESCRIPTION


2018-01-04  Minsheng Liu  <lambda@liu.ms>

  Refactor "solveFE".

  Rewrite the function as "solve.fixed.effects".
  "solveFE" is kept as a wrapper for backward compatibility.

  modified:   R/Wrapper.R

  There is no behavior change so new tests are not required.


2018-01-04  Minsheng Liu  <lambda@liu.ms>

  Refactor "FixedEffect::fromColumn".

  Simplify the logic as hashing for indicators is done in R now.
  Also, remove the unused "FixedEffect::indices" instance variable.

  modified:   src/FixedEffect.cpp
  modified:   src/FixedEffect.h


2018-01-04  Minsheng Liu  <lambda@liu.ms>

  Remove unnecessary files.

  Delete R Studio project file since R Studio is no longer used,

  deleted:    fastplm.Rproj

  Packaging is done by "devtools" rather than "Makefile".

  modified:   Makefile


2018-01-02  Minsheng Liu  <lambda@liu.ms>

  "predictFE" now produces a warning when an unknown indicator occurs.

  The logic of "predictFE" is rewritten and moved to "predict.fixed.effects".
  The new function employs a more canonical R style (more functional, less
  imperative). The warning message is generated from a function in "messages.R",
  which makes testing much easier.

  modified:   R/Wrapper.R
  new file:   R/messages.R

  Export only "solveFE", "solveGP", and "predictFE". All other internal functions
  are now hidden.

  modified:   NAMESPACE

  Add unit test for "predictFE" with unknown indicators.

  new file:   tests/testthat/test-predict-fixed-effects-with-unknown-indicators.R

  Remove the unnecessary call "library(fastplm)" as "testthat" loads "fastplm"
  automatically.

  modified:   tests/testthat/test-demean-fixed-effects.R
  modified:   tests/testthat/test-predict-fixed-effects.R

  Bump the version to 0.1.6.0 to reflect the interface change.

  modified:   DESCRIPTION


2018-01-02  Minsheng Liu  <lambda@liu.ms>

  Update "test-predict-fixed-effects.R": isomorphic group indicators give equal
  but not identical prediction.

  Note that even for isomorphic group indicators, the demeaning process will
  yield different results due to float point error if the order of group
  indicators after "factor" differ. The affected test,

    tests/testthat/test-predict-fixed-effects.R

  mistakenly assumed that by changing indicators from 1, 2, ..., N to
  %prefix%.1, %prefix%.2, ..., %prefix%.N, the order of group indicators after
  "factor" will remain the same. However, the canonical sorting for strings
  will yield

    1 > 10 > 11 > ... > 2 > 20 > 21

  rather than

    1 > 2 > ... > 10 > 11 > ... > 20 > 21.

  So the assumption is wrong. As a result, "expect_equal" rather than
  "expect_identical" should be used.

  modified:   tests/testthat/test-predict-fixed-effects.R


2018-01-01  Minsheng Liu  <lambda@liu.ms>

  Bump the version number to 0.1.5.3 to reflect recent bug fixes.

  Note that previously 0.1.5.2 was released but the git commits were not pushed
  to the repository so it stayed 0.1.5.1. This change is to avoid conflict when
  installing this package.

  E-mail address for Minsheng Liu is also updated.

  modified:   DESCRIPTION


2018-01-01  Minsheng Liu  <lambda@liu.ms>

  Handle group indicators of type "character" for "predictFE".

  The bug is the same as the one fixed in commit 628681518ecb8aacabbfc8c24a8a3db4035f7473
  (https://github.com/xuyiqing/fastplm/commit/628681518ecb8aacabbfc8c24a8a3db4035f7473).
  This time it occurs in "predictFE".

  modified:   R/Wrapper.R

  Add unit test for predicting fixed effects. We compare the predicted results
  using the same X used for "solveFE" with fitted values given by the latter.
  The following two situations are checked:

  * group indicators ranging from 1 consecutively to N
  * some random character-based indicators

  new file:   tests/testthat/test-predict-fixed-effects.R

  Functions from
    tests/testthat/test-demean-fixed-effects.R
  are abstracted into
    tests/testthat/make-small-data.R
  for reusing. Also, group values are renamed as group indicators for consistency.

  new file:   tests/testthat/make-small-data.R
  modified:   tests/testthat/test-demean-fixed-effects.R


2018-01-01  Minsheng Liu  <lambda@liu.ms>

  Handle group indicators of type "character".

  In "R/Wrapper.R", f the input group indicators are of type "character", 
  the factor-ed indicators will also be coerced into "character".
  This change assign each column of the factor-ed indicators into a new
  variable to avoid the "coercion pollution".

  modified:   R/Wrapper.R

  Add unit test for demeaning fixed effects. We compare

  * the coefficients given by "solveFE" and "felm"
  * two outputs by "solveFE" supplied with
    * group indicators ranging from 1 consecutively to N
    * some random character-based indicators

  new file:   tests/testthat/test-demean-fixed-effects.R


2018-01-01  Minsheng Liu  <lambda@liu.ms>

  Employ "testthat" for unit tests.

  modified:   .gitignore
  modified:   DESCRIPTION
  modified:   NAMESPACE
  new file:   R/catch-routine-registration.R
  new file:   src/test-runner.cpp
  new file:   tests/testthat.R
